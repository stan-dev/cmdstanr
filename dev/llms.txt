# CmdStanR

### Overview

CmdStanR is a lightweight interface to [Stan](https://mc-stan.org) for R
users (see [CmdStanPy](https://github.com/stan-dev/cmdstanpy) for
Python).

If you are new to CmdStanR we recommend starting with these vignettes:

- [*Getting started with
  CmdStanR*](https://mc-stan.org/cmdstanr/articles/cmdstanr.html)

- [*How does CmdStanR
  work?*](https://mc-stan.org/cmdstanr/articles/cmdstanr-internals.html)

### Goals

- A clean interface to Stan services so that CmdStanR can keep up with
  Stan releases.

- R code that doesn’t interface directly with C++, only calls compiled
  executables.

- Modularity: CmdStanR runs Stan’s algorithms and lets downstream
  modules do the analysis.

- Flexible [BSD-3 license](https://opensource.org/license/bsd-3-clause).

### Installation

#### Installing the R package

You can install the latest release of the **cmdstanr** R package with

``` r
# we recommend running this in a fresh R session or restarting your current session
install.packages("cmdstanr", repos = c('https://stan-dev.r-universe.dev', getOption("repos")))
```

This does not install the vignettes, which take a long time to build,
but they are always available online at
<https://mc-stan.org/cmdstanr/articles/>.

To instead install the latest development version of the package from
GitHub use

``` r
# install.packages("remotes")
remotes::install_github("stan-dev/cmdstanr")
```

#### Installing CmdStan

If you don’t already have CmdStan installed then, in addition to
installing the R package, it is also necessary to install CmdStan using
CmdStanR’s
[`install_cmdstan()`](https://mc-stan.org/cmdstanr/dev/reference/install_cmdstan.md)
function. A suitable C++ toolchain is also required. Instructions are
provided in the [*Getting started with
CmdStanR*](https://mc-stan.org/cmdstanr/articles/cmdstanr.html)
vignette.

### Contributing

There is a lot of work still to be done, and we welcome contributions
from anyone! If you are interested in contributing, please [comment on
an open issue or open a new
one](https://github.com/stan-dev/cmdstanr/issues) on GitHub. For more
details, please check
[CONTRIBUTING.md](https://github.com/stan-dev/cmdstanr/blob/fe126708f53d89ecd889d2f122f6bd69c7404836/.github/CONTRIBUTING.md).
\### License

CmdStanR, like CmdStan and the core Stan C++ code, is licensed under the
following licenses:

- Code: BSD 3-clause (<https://opensource.org/license/bsd-3-clause/>)
- Documentation: CC-BY 4.0
  (<https://creativecommons.org/licenses/by/4.0/>)

# Package index

## Package overview and global options

An overview of the package and how it differs from
[RStan](https://mc-stan.org/rstan).

- [`cmdstanr-package`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr-package.md)
  [`cmdstanr`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr-package.md)
  [`CmdStanR`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr-package.md)
  : CmdStanR: the R interface to CmdStan
- [`cmdstanr_global_options`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr_global_options.md)
  : CmdStanR global options

## Installing and setting the path to CmdStan

Install CmdStan, assuming the necessary C++ toolchain.

- [`install_cmdstan()`](https://mc-stan.org/cmdstanr/dev/reference/install_cmdstan.md)
  [`rebuild_cmdstan()`](https://mc-stan.org/cmdstanr/dev/reference/install_cmdstan.md)
  [`cmdstan_make_local()`](https://mc-stan.org/cmdstanr/dev/reference/install_cmdstan.md)
  [`check_cmdstan_toolchain()`](https://mc-stan.org/cmdstanr/dev/reference/install_cmdstan.md)
  : Install CmdStan or clean and rebuild an existing installation
- [`set_cmdstan_path()`](https://mc-stan.org/cmdstanr/dev/reference/set_cmdstan_path.md)
  [`cmdstan_path()`](https://mc-stan.org/cmdstanr/dev/reference/set_cmdstan_path.md)
  [`cmdstan_version()`](https://mc-stan.org/cmdstanr/dev/reference/set_cmdstan_path.md)
  : Get or set the file path to the CmdStan installation

## Running CmdStan from R

Run CmdStan from R.

- [`cmdstan_model()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_model.md)
  : Create a new CmdStanModel object
- [`CmdStanModel`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanModel.md)
  : CmdStanModel objects
- [`check_syntax()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-check_syntax.md)
  : Check syntax of a Stan program
- [`compile()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-compile.md)
  : Compile a Stan program
- [`diagnose()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-diagnose.md)
  : Run Stan's diagnose method
- [`expose_functions()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-expose_functions.md)
  : Expose Stan functions to R
- [`format()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-format.md)
  : Run stanc's auto-formatter on the model code.
- [`generate_quantities()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-generate-quantities.md)
  : Run Stan's standalone generated quantities method
- [`laplace()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-laplace.md)
  : Run Stan's Laplace algorithm
- [`optimize()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-optimize.md)
  : Run Stan's optimization algorithms
- [`pathfinder()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-pathfinder.md)
  : Run Stan's Pathfinder Variational Inference Algorithm
- [`sample()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-sample.md)
  : Run Stan's MCMC algorithms
- [`sample_mpi()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-sample_mpi.md)
  : Run Stan's MCMC algorithms with MPI
- [`variables()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-variables.md)
  : Input and output variables of a Stan program
- [`variational()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-variational.md)
  : Run Stan's variational approximation algorithms
- [`cmdstanr_example()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr_example.md)
  [`print_example_program()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstanr_example.md)
  : Fit models for use in examples

## Fitted model objects and methods

- [`CmdStanMCMC`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanMCMC.md)
  : CmdStanMCMC objects

- [`CmdStanMLE`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanMLE.md)
  : CmdStanMLE objects

- [`CmdStanLaplace`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanLaplace.md)
  : CmdStanLaplace objects

- [`CmdStanVB`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanVB.md)
  : CmdStanVB objects

- [`CmdStanPathfinder`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanPathfinder.md)
  : CmdStanPathfinder objects

- [`CmdStanGQ`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanGQ.md)
  : CmdStanGQ objects

- [`CmdStanDiagnose`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanDiagnose.md)
  : CmdStanDiagnose objects

- [`cmdstan_summary()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-cmdstan_summary.md)
  [`cmdstan_diagnose()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-cmdstan_summary.md)
  :

  Run CmdStan's `stansummary` and `diagnose` utilities

- [`code()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-code.md)
  : Return Stan code

- [`constrain_variables()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-constrain_variables.md)
  : Transform a set of unconstrained parameter values to the constrained
  scale

- [`diagnostic_summary()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-diagnostic_summary.md)
  : Sampler diagnostic summaries and warnings

- [`draws()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-draws.md)
  : Extract posterior draws

- [`grad_log_prob()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-grad_log_prob.md)
  : Calculate the log-probability and the gradient w.r.t. each input for
  a given vector of unconstrained parameters

- [`gradients()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-gradients.md)
  : Extract gradients after diagnostic mode

- [`hessian()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-hessian.md)
  : Calculate the log-probability , the gradient w.r.t. each input, and
  the hessian for a given vector of unconstrained parameters

- [`init()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-init.md)
  : Extract user-specified initial values

- [`init_model_methods()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-init_model_methods.md)
  : Compile additional methods for accessing the model log-probability
  function and parameter constraining and unconstraining.

- [`inv_metric()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-inv_metric.md)
  : Extract inverse metric (mass matrix) after MCMC

- [`log_prob()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-log_prob.md)
  : Calculate the log-probability given a provided vector of
  unconstrained parameters.

- [`loo()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-loo.md)
  : Leave-one-out cross-validation (LOO-CV)

- [`lp()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-lp.md)
  [`lp_approx()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-lp.md)
  : Extract log probability (target)

- [`metadata()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-metadata.md)
  : Extract metadata from CmdStan CSV files

- [`mle()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-mle.md)
  : Extract point estimate after optimization

- [`num_chains()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-num_chains.md)
  : Extract number of chains after MCMC

- [`output()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-output.md)
  : Access console output

- [`profiles()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-profiles.md)
  : Return profiling data

- [`return_codes()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-return_codes.md)
  : Extract return codes from CmdStan

- [`sampler_diagnostics()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-sampler_diagnostics.md)
  : Extract sampler diagnostics after MCMC

- [`save_object()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_object.md)
  : Save fitted model object to a file

- [`save_output_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`save_latent_dynamics_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`save_profile_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`save_data_file()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`save_config_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`save_metric_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`output_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`profile_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`latent_dynamics_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`data_file()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`config_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  [`metric_files()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-save_output_files.md)
  : Save output and data files

- [`summary()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-summary.md)
  : Compute a summary table of estimates and diagnostics

- [`time()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-time.md)
  : Report timing of CmdStan runs

- [`unconstrain_draws()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-unconstrain_draws.md)
  : Transform all parameter draws to the unconstrained scale

- [`unconstrain_variables()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-unconstrain_variables.md)
  : Transform a set of parameter values to the unconstrained scale

- [`variable_skeleton()`](https://mc-stan.org/cmdstanr/dev/reference/fit-method-variable_skeleton.md)
  :

  Return the variable skeleton for `relist`

- [`expose_functions()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-expose_functions.md)
  : Expose Stan functions to R

## Other tools

- [`read_cmdstan_csv()`](https://mc-stan.org/cmdstanr/dev/reference/read_cmdstan_csv.md)
  [`as_cmdstan_fit()`](https://mc-stan.org/cmdstanr/dev/reference/read_cmdstan_csv.md)
  : Read CmdStan CSV files into R

- [`write_stan_json()`](https://mc-stan.org/cmdstanr/dev/reference/write_stan_json.md)
  : Write data to a JSON file readable by CmdStan

- [`write_stan_file()`](https://mc-stan.org/cmdstanr/dev/reference/write_stan_file.md)
  : Write Stan code to a file

- [`draws_to_csv()`](https://mc-stan.org/cmdstanr/dev/reference/draws_to_csv.md)
  : Write posterior draws objects to CSV files suitable for running
  standalone generated quantities with CmdStan.

- [`as_mcmc.list()`](https://mc-stan.org/cmdstanr/dev/reference/as_mcmc.list.md)
  :

  Convert `CmdStanMCMC` to `mcmc.list`

- [`as_draws(`*`<CmdStanMCMC>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  [`as_draws(`*`<CmdStanMLE>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  [`as_draws(`*`<CmdStanLaplace>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  [`as_draws(`*`<CmdStanVB>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  [`as_draws(`*`<CmdStanGQ>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  [`as_draws(`*`<CmdStanPathfinder>`*`)`](https://mc-stan.org/cmdstanr/dev/reference/as_draws.CmdStanMCMC.md)
  :

  Create a `draws` object from a CmdStanR fitted model object

- [`as.CmdStanMCMC()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanMLE()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanLaplace()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanVB()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanPathfinder()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanGQ()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  [`as.CmdStanDiagnose()`](https://mc-stan.org/cmdstanr/dev/reference/cmdstan_coercion.md)
  : Coercion methods for CmdStan objects

## Using CmdStanR with knitr and R Markdown

- [`register_knitr_engine()`](https://mc-stan.org/cmdstanr/dev/reference/register_knitr_engine.md)
  : Register CmdStanR's knitr engine for Stan
- [`eng_cmdstan()`](https://mc-stan.org/cmdstanr/dev/reference/eng_cmdstan.md)
  : CmdStan knitr engine for Stan

# Articles

### Getting started

Installing CmdStan, fitting models, and accessing results.

- [Getting started with
  CmdStanR](https://mc-stan.org/cmdstanr/dev/articles/cmdstanr.md):

### More details

More information about compilation, passing in data, how CmdStan ouput
is written to CSV and read back into R, profiling Stan programs, running
Stan on GPUs, and using CmdStanR in R Markdown documents.

- [How does CmdStanR
  work?](https://mc-stan.org/cmdstanr/dev/articles/cmdstanr-internals.md):
- [Working with
  Posteriors](https://mc-stan.org/cmdstanr/dev/articles/posterior.md):
- [R Markdown CmdStan
  Engine](https://mc-stan.org/cmdstanr/dev/articles/r-markdown.md):
- [Profiling Stan programs with
  CmdStanR](https://mc-stan.org/cmdstanr/dev/articles/profiling.md):
- [Running Stan on the GPU with
  OpenCL](https://mc-stan.org/cmdstanr/dev/articles/articles-online-only/opencl.md):

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit models for use in examples — cmdstanr_example • cmdstanr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit models for use in examples — cmdstanr_example"><meta name="description" content="Fit models for use in examples"><meta property="og:description" content="Fit models for use in examples"><meta property="og:image" content="https://mc-stan.org/cmdstanr/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      cmdstanr
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.9.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/cmdstanr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit models for use in examples</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/cmdstanr/blob/master/R/example.R" class="external-link"><code>R/example.R</code></a></small>
      <div class="d-none name"><code>cmdstanr_example.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit models for use in examples</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cmdstanr_example</span><span class="op">(</span></span>
<span>  example <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"schools"</span>, <span class="st">"schools_ncp"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="st">"optimize"</span>, <span class="st">"laplace"</span>, <span class="st">"variational"</span>, <span class="st">"pathfinder"</span>, <span class="st">"diagnose"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force_recompile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"cmdstanr_force_recompile"</span>, default <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">print_example_program</span><span class="op">(</span>example <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"schools"</span>, <span class="st">"schools_ncp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-example">example<a class="anchor" aria-label="anchor" href="#arg-example"></a></dt>
<dd><p>(string) The name of the example. The currently available
examples are</p><ul><li><p><code>"logistic"</code>: logistic regression with intercept and 3 predictors.</p></li>
<li><p><code>"schools"</code>: the so-called "eight schools" model, a hierarchical
meta-analysis. Fitting this model will result in warnings about
divergences.</p></li>
<li><p><code>"schools_ncp"</code>: non-centered parameterization of the "eight schools"
model that fixes the problem with divergences.</p></li>
</ul><p>To print the Stan code for a given <code>example</code> use
<code>print_example_program(example)</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>(string) Which fitting method should be used? The default is
the <code>"sample"</code> method (MCMC).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to the chosen <code>method</code>. See the help pages for
the individual methods for details.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>(logical) If <code>TRUE</code> (the default) then fitting the model is
wrapped in <code><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">utils::capture.output()</a></code>.</p></dd>


<dt id="arg-force-recompile">force_recompile<a class="anchor" aria-label="anchor" href="#arg-force-recompile"></a></dt>
<dd><p>Passed to the <a href="model-method-compile.html">$compile()</a> method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The fitted model object returned by the selected <code>method</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">print_example_program</span><span class="op">(</span><span class="st">"logistic"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   int&lt;lower=0&gt; N;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   int&lt;lower=0&gt; K;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   array[N] int&lt;lower=0, upper=1&gt; y;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   matrix[N, K] X;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parameters {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   real alpha;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[K] beta;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(alpha | 0, 1);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(beta | 0, 1);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += bernoulli_logit_glm_lpmf(y | X, alpha, beta);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> generated quantities {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[N] log_lik;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   for (n in 1 : N) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     log_lik[n] = bernoulli_logit_lpmf(y[n] | alpha + X[n] * beta);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-in"><span><span class="va">fit_logistic_mcmc</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"logistic"</span>, chains <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_logistic_mcmc</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 105 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable      mean  median    sd    mad         q5      q95  rhat ess_bulk</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> lp__       -<span style="color: #BB0000;">66.0</span>   -<span style="color: #BB0000;">65.7</span>   1.45  1.28   -<span style="color: #BB0000;">68.8</span>      -<span style="color: #BB0000;">64.3</span>    0.999    <span style="text-decoration: underline;">1</span>047.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> alpha        0.374   0.374 0.223 0.216   -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">371</span>   0.737  1.000    <span style="text-decoration: underline;">1</span>996.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> beta[1]     -<span style="color: #BB0000;">0.679</span>  -<span style="color: #BB0000;">0.670</span> 0.261 0.259   -<span style="color: #BB0000;">1.12</span>      -<span style="color: #BB0000;">0.266</span>  1.00     <span style="text-decoration: underline;">2</span>471.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> beta[2]     -<span style="color: #BB0000;">0.280</span>  -<span style="color: #BB0000;">0.279</span> 0.219 0.217   -<span style="color: #BB0000;">0.657</span>      0.067<span style="text-decoration: underline;">7</span> 1.000    <span style="text-decoration: underline;">2</span>142.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> beta[3]      0.689   0.686 0.265 0.274    0.257      1.11   1.00     <span style="text-decoration: underline;">1</span>976.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> log_lik[1]  -<span style="color: #BB0000;">0.518</span>  -<span style="color: #BB0000;">0.512</span> 0.101 0.095<span style="text-decoration: underline;">1</span>  -<span style="color: #BB0000;">0.699</span>     -<span style="color: #BB0000;">0.360</span>  1.000    <span style="text-decoration: underline;">2</span>111.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> log_lik[2]  -<span style="color: #BB0000;">0.395</span>  -<span style="color: #BB0000;">0.377</span> 0.141 0.131   -<span style="color: #BB0000;">0.646</span>     -<span style="color: #BB0000;">0.192</span>  1.000    <span style="text-decoration: underline;">2</span>157.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> log_lik[3]  -<span style="color: #BB0000;">0.501</span>  -<span style="color: #BB0000;">0.471</span> 0.219 0.202   -<span style="color: #BB0000;">0.910</span>     -<span style="color: #BB0000;">0.206</span>  1.00     <span style="text-decoration: underline;">2</span>228.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> log_lik[4]  -<span style="color: #BB0000;">0.442</span>  -<span style="color: #BB0000;">0.427</span> 0.150 0.150   -<span style="color: #BB0000;">0.707</span>     -<span style="color: #BB0000;">0.231</span>  1.000    <span style="text-decoration: underline;">1</span>983.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> log_lik[5]  -<span style="color: #BB0000;">1.18</span>   -<span style="color: #BB0000;">1.16</span>  0.286 0.283   -<span style="color: #BB0000;">1.68</span>      -<span style="color: #BB0000;">0.750</span>  1.00     <span style="text-decoration: underline;">2</span>106.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 95 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: ess_tail &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_logistic_optim</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"logistic"</span>, method <span class="op">=</span> <span class="st">"optimize"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_logistic_optim</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 105 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable   estimate</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> lp__        -<span style="color: #BB0000;">63.9</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> alpha         0.364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> beta[1]      -<span style="color: #BB0000;">0.632</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> beta[2]      -<span style="color: #BB0000;">0.259</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> beta[3]       0.649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> log_lik[1]   -<span style="color: #BB0000;">0.515</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> log_lik[2]   -<span style="color: #BB0000;">0.394</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> log_lik[3]   -<span style="color: #BB0000;">0.469</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> log_lik[4]   -<span style="color: #BB0000;">0.442</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> log_lik[5]   -<span style="color: #BB0000;">1.14</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 95 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit_logistic_vb</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"logistic"</span>, method <span class="op">=</span> <span class="st">"variational"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_logistic_vb</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 106 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable       mean  median    sd    mad       q5      q95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> lp__        -<span style="color: #BB0000;">66.1</span>   -<span style="color: #BB0000;">65.7</span>   1.50  1.28   -<span style="color: #BB0000;">68.9</span>    -<span style="color: #BB0000;">64.3</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> lp_approx__  -<span style="color: #BB0000;">1.98</span>   -<span style="color: #BB0000;">1.68</span>  1.35  1.19    -<span style="color: #BB0000;">4.59</span>    -<span style="color: #BB0000;">0.381</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> alpha         0.272   0.281 0.205 0.208   -<span style="color: #BB0000;">0.070</span><span style="color: #BB0000; text-decoration: underline;">9</span>   0.609 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> beta[1]      -<span style="color: #BB0000;">0.649</span>  -<span style="color: #BB0000;">0.647</span> 0.258 0.251   -<span style="color: #BB0000;">1.08</span>    -<span style="color: #BB0000;">0.224</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> beta[2]      -<span style="color: #BB0000;">0.336</span>  -<span style="color: #BB0000;">0.338</span> 0.226 0.228   -<span style="color: #BB0000;">0.711</span>    0.037<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> beta[3]       0.666   0.668 0.237 0.239    0.277    1.05  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> log_lik[1]   -<span style="color: #BB0000;">0.567</span>  -<span style="color: #BB0000;">0.558</span> 0.101 0.098<span style="text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.742</span>   -<span style="color: #BB0000;">0.416</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> log_lik[2]   -<span style="color: #BB0000;">0.388</span>  -<span style="color: #BB0000;">0.364</span> 0.138 0.132   -<span style="color: #BB0000;">0.646</span>   -<span style="color: #BB0000;">0.198</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> log_lik[3]   -<span style="color: #BB0000;">0.602</span>  -<span style="color: #BB0000;">0.567</span> 0.249 0.233   -<span style="color: #BB0000;">1.07</span>    -<span style="color: #BB0000;">0.263</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> log_lik[4]   -<span style="color: #BB0000;">0.391</span>  -<span style="color: #BB0000;">0.374</span> 0.124 0.121   -<span style="color: #BB0000;">0.626</span>   -<span style="color: #BB0000;">0.219</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 96 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">print_example_program</span><span class="op">(</span><span class="st">"schools"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   int&lt;lower=1&gt; J;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector&lt;lower=0&gt;[J] sigma;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[J] y;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parameters {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   real mu;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   real&lt;lower=0&gt; tau;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[J] theta;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(tau | 0, 10);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(mu | 0, 10);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(theta | mu, tau);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(y | theta, sigma);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-in"><span><span class="va">fit_schools_mcmc</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"schools"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Warning: 100 of 4000 (2.0%) transitions ended with a divergence.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> See https://mc-stan.org/misc/warnings for details.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Warning: 2 of 4 chains had an E-BFMI less than 0.3.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> See https://mc-stan.org/misc/warnings for details.</span>
<span class="r-in"><span><span class="va">fit_schools_mcmc</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 11 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable   mean median    sd   mad       q5   q95  rhat ess_bulk ess_tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> lp__     -<span style="color: #BB0000;">57.5</span>  -<span style="color: #BB0000;">57.9</span>   5.57  5.90 -<span style="color: #BB0000;">66.2</span>    -<span style="color: #BB0000;">47.9</span>  1.01     202.     87.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> mu         6.76   6.73  4.09  4.04   0.080<span style="text-decoration: underline;">9</span>  13.4  1.01     606.    673. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> tau        5.07   4.17  3.60  3.21   1.03    12.2  1.01     203.     73.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> theta[1]   9.37   8.58  6.86  5.88  -<span style="color: #BB0000;">0.166</span>   21.5  1.01     837.   <span style="text-decoration: underline;">1</span>605. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> theta[2]   7.19   7.19  5.50  5.08  -<span style="color: #BB0000;">1.72</span>    16.3  1.01    <span style="text-decoration: underline;">1</span>122.   <span style="text-decoration: underline;">2</span>330. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> theta[3]   5.66   6.01  6.49  5.61  -<span style="color: #BB0000;">5.61</span>    15.5  1.00     931.   <span style="text-decoration: underline;">1</span>788. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> theta[4]   6.81   6.97  5.66  5.30  -<span style="color: #BB0000;">2.93</span>    15.8  1.01     956.   <span style="text-decoration: underline;">1</span>997. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> theta[5]   4.97   5.51  5.52  5.15  -<span style="color: #BB0000;">4.65</span>    13.1  1.01     818.    809. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> theta[6]   5.83   6.13  5.86  5.33  -<span style="color: #BB0000;">4.43</span>    14.6  1.01    <span style="text-decoration: underline;">1</span>088.   <span style="text-decoration: underline;">2</span>229. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> theta[7]   9.21   8.87  5.76  5.39   0.754   19.1  1.00     755.   <span style="text-decoration: underline;">1</span>603. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> theta[8]   7.34   7.21  6.58  5.64  -<span style="color: #BB0000;">3.38</span>    17.9  1.01    <span style="text-decoration: underline;">1</span>151.   <span style="text-decoration: underline;">1</span>785. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">print_example_program</span><span class="op">(</span><span class="st">"schools_ncp"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   int&lt;lower=1&gt; J;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector&lt;lower=0&gt;[J] sigma;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[J] y;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parameters {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   real mu;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   real&lt;lower=0&gt; tau;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[J] theta_raw;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> transformed parameters {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   vector[J] theta = mu + tau * theta_raw;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(tau | 0, 10);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(mu | 0, 10);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(theta_raw | 0, 1);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target += normal_lpdf(y | theta, sigma);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-in"><span><span class="va">fit_schools_ncp_mcmc</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"schools_ncp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Warning: 1 of 4000 (0.0%) transitions ended with a divergence.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> See https://mc-stan.org/misc/warnings for details.</span>
<span class="r-in"><span><span class="va">fit_schools_ncp_mcmc</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    variable     mean   median    sd   mad      q5    q95  rhat ess_bulk ess_tail</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> lp__     -<span style="color: #BB0000;">46.8</span>    -<span style="color: #BB0000;">46.6</span>    2.42  2.39  -<span style="color: #BB0000;">51.2</span>   -<span style="color: #BB0000;">43.4</span>  1.00     <span style="text-decoration: underline;">1</span>597.    <span style="text-decoration: underline;">2</span>363.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> mu         6.51     6.57   4.16  4.02   -<span style="color: #BB0000;">0.472</span>  13.4  1.00     <span style="text-decoration: underline;">3</span>174.    <span style="text-decoration: underline;">2</span>417.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> tau        4.78     4.01   3.65  3.46    0.414  11.9  1.00     <span style="text-decoration: underline;">2</span>041.    <span style="text-decoration: underline;">2</span>013.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> theta_r…   0.376    0.383  0.968 0.993  -<span style="color: #BB0000;">1.25</span>    1.94 1.00     <span style="text-decoration: underline;">4</span>078.    <span style="text-decoration: underline;">2</span>970.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> theta_r…   0.053<span style="text-decoration: underline;">9</span>   0.047<span style="text-decoration: underline;">8</span> 0.889 0.863  -<span style="color: #BB0000;">1.43</span>    1.50 1.000    <span style="text-decoration: underline;">3</span>497.    <span style="text-decoration: underline;">2</span>765.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> theta_r…  -<span style="color: #BB0000;">0.162</span>   -<span style="color: #BB0000;">0.169</span>  0.948 0.939  -<span style="color: #BB0000;">1.71</span>    1.44 1.00     <span style="text-decoration: underline;">4</span>253.    <span style="text-decoration: underline;">3</span>063.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> theta_r…   0.021<span style="text-decoration: underline;">0</span>   0.028<span style="text-decoration: underline;">3</span> 0.924 0.919  -<span style="color: #BB0000;">1.54</span>    1.55 1.00     <span style="text-decoration: underline;">4</span>003.    <span style="text-decoration: underline;">2</span>595.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> theta_r…  -<span style="color: #BB0000;">0.279</span>   -<span style="color: #BB0000;">0.279</span>  0.927 0.909  -<span style="color: #BB0000;">1.80</span>    1.29 1.00     <span style="text-decoration: underline;">4</span>657.    <span style="text-decoration: underline;">2</span>974.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> theta_r…  -<span style="color: #BB0000;">0.156</span>   -<span style="color: #BB0000;">0.173</span>  0.923 0.923  -<span style="color: #BB0000;">1.67</span>    1.38 1.00     <span style="text-decoration: underline;">4</span>131.    <span style="text-decoration: underline;">2</span>764.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> theta_r…   0.356    0.361  0.895 0.861  -<span style="color: #BB0000;">1.12</span>    1.79 1.00     <span style="text-decoration: underline;">3</span>913.    <span style="text-decoration: underline;">2</span>847.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> theta_r…   0.072<span style="text-decoration: underline;">8</span>   0.071<span style="text-decoration: underline;">1</span> 0.962 0.938  -<span style="color: #BB0000;">1.52</span>    1.68 1.00     <span style="text-decoration: underline;">4</span>201.    <span style="text-decoration: underline;">2</span>578.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> theta[1]   9.00     8.38   6.61  5.70   -<span style="color: #BB0000;">0.496</span>  21.2  1.00     <span style="text-decoration: underline;">3</span>941.    <span style="text-decoration: underline;">2</span>930.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> theta[2]   6.93     6.90   5.52  5.05   -<span style="color: #BB0000;">1.93</span>   16.1  1.00     <span style="text-decoration: underline;">4</span>037.    <span style="text-decoration: underline;">3</span>058.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> theta[3]   5.42     5.83   6.41  5.64   -<span style="color: #BB0000;">5.91</span>   15.0  1.00     <span style="text-decoration: underline;">3</span>598.    <span style="text-decoration: underline;">2</span>668.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> theta[4]   6.76     6.70   5.56  5.12   -<span style="color: #BB0000;">2.29</span>   15.8  1.00     <span style="text-decoration: underline;">4</span>455.    <span style="text-decoration: underline;">3</span>296.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> theta[5]   4.83     5.19   5.68  5.38   -<span style="color: #BB0000;">5.17</span>   13.4  1.00     <span style="text-decoration: underline;">4</span>228.    <span style="text-decoration: underline;">3</span>006.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> theta[6]   5.48     5.82   5.98  5.28   -<span style="color: #BB0000;">4.72</span>   14.6  1.00     <span style="text-decoration: underline;">4</span>230.    <span style="text-decoration: underline;">3</span>151.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> theta[7]   8.74     8.39   5.64  5.27    0.391  18.7  1.00     <span style="text-decoration: underline;">3</span>385.    <span style="text-decoration: underline;">3</span>292.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> theta[8]   7.01     6.90   6.63  5.59   -<span style="color: #BB0000;">3.68</span>   17.6  1.00     <span style="text-decoration: underline;">3</span>930.    <span style="text-decoration: underline;">3</span>203.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># optimization fails for hierarchical model</span></span></span>
<span class="r-in"><span><span class="fu">cmdstanr_example</span><span class="op">(</span><span class="st">"schools"</span>, <span class="st">"optimize"</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial log joint probability = -57.1252 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       99       122.724      0.164532   4.55678e+09      0.4431      0.4431      178    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Iter      log prob        ||dx||      ||grad||       alpha      alpha0  # evals  Notes  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      183       248.408     0.0553432   4.75335e+16       1e-12       0.001      393  LS failed, Hessian reset  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1 Optimization terminated with error: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Chain 1   Line search failed to achieve a sufficient decrease, no more progress can be made</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Fitting finished unexpectedly! Use the $output() method for more information.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finished in  0.1 seconds.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> Fitting failed. Unable to print.</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Rok Češnovar, Andrew Johnson, Steve Bronder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>


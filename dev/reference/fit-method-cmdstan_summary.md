# Run CmdStan's `stansummary` and `diagnose` utilities

Run CmdStan's `stansummary` and `diagnose` utilities. These are
documented in the CmdStan Guide:

- https://mc-stan.org/docs/cmdstan-guide/stansummary.html

- https://mc-stan.org/docs/cmdstan-guide/diagnose.html

Although these methods can be used for models fit using the
[`$variational()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-variational.md)
method, much of the output is currently only relevant for models fit
using the
[`$sample()`](https://mc-stan.org/cmdstanr/dev/reference/model-method-sample.md)
method.

See the
[\$summary()](https://mc-stan.org/cmdstanr/dev/reference/fit-method-summary.md)
for computing similar summaries in R rather than calling CmdStan's
utilites.

## Usage

``` r
cmdstan_summary(flags = NULL)

cmdstan_diagnose()
```

## Arguments

- flags:

  An optional character vector of flags (e.g.
  `flags = c("--sig_figs=1")`).

## See also

[`CmdStanMCMC`](https://mc-stan.org/cmdstanr/dev/reference/CmdStanMCMC.md),
[fit-method-summary](https://mc-stan.org/cmdstanr/dev/reference/fit-method-summary.md)

## Examples

``` r
# \dontrun{
fit <- cmdstanr_example("logistic")
fit$cmdstan_diagnose()
#> Checking sampler transitions treedepth.
#> Treedepth satisfactory for all transitions.
#> 
#> Checking sampler transitions for divergences.
#> No divergent transitions found.
#> 
#> Checking E-BFMI - sampler transitions HMC potential energy.
#> E-BFMI satisfactory.
#> 
#> Rank-normalized split effective sample size satisfactory for all parameters.
#> 
#> Rank-normalized split R-hat values satisfactory for all parameters.
#> 
#> Processing complete, no problems detected.
fit$cmdstan_summary()
#> Inference for Stan model: logistic_model
#> 4 chains: each with iter=1000; warmup=1000; thin=1; 1000 iterations saved.
#> 
#> Warmup took (0.020, 0.019, 0.020, 0.019) seconds, 0.078 seconds total
#> Sampling took (0.057, 0.054, 0.055, 0.056) seconds, 0.22 seconds total
#> 
#>                     Mean     MCSE  StdDev    MAD     5%       50%       95%  ESS_bulk  ESS_tail  ESS_bulk/s  R_hat
#> 
#> lp__            -6.6e+01  3.1e-02     1.4    1.3    -69  -6.6e+01  -6.4e+01      2186      3208        9845    1.0
#> accept_stat__       0.90  1.5e-03    0.11  0.082   0.68      0.94       1.0      5398      4191       24314    1.0
#> stepsize__          0.77      nan   0.065  0.040   0.71      0.75      0.88       nan       nan         nan    nan
#> treedepth__          2.4  5.2e-02    0.53   0.00    2.0       2.0       3.0       268       199        1208    1.0
#> n_leapfrog__         5.1  1.6e-01     2.0   0.00    3.0       7.0       7.0       477       375        2151    1.0
#> divergent__         0.00      nan    0.00   0.00   0.00      0.00      0.00       nan       nan         nan    nan
#> energy__              68  4.8e-02     2.0    1.9     65        68        72      1813      2788        8168    1.0
#> 
#> alpha            3.7e-01  3.6e-03    0.22   0.22  0.019   3.7e-01   7.5e-01      3749      3277       16889    1.0
#> beta[1]         -6.7e-01  3.9e-03    0.25   0.25   -1.1  -6.7e-01  -2.7e-01      4263      2751       19201    1.0
#> beta[2]         -2.7e-01  3.5e-03    0.23   0.22  -0.66  -2.7e-01   9.7e-02      4080      2981       18378    1.0
#> beta[3]          6.8e-01  4.4e-03    0.27   0.28   0.26   6.7e-01   1.1e+00      3765      2580       16957    1.0
#> log_lik[1]      -5.2e-01  1.6e-03   0.099  0.099  -0.69  -5.1e-01  -3.7e-01      3973      3220       17895    1.0
#> log_lik[2]      -4.0e-01  2.1e-03    0.15   0.14  -0.66  -3.8e-01  -2.0e-01      4673      3229       21049    1.0
#> log_lik[3]      -5.0e-01  3.5e-03    0.22   0.21  -0.90  -4.7e-01  -2.1e-01      4140      3008       18650    1.0
#> log_lik[4]      -4.5e-01  2.4e-03    0.15   0.14  -0.72  -4.3e-01  -2.4e-01      3972      3013       17893    1.0
#> log_lik[5]      -1.2e+00  4.7e-03    0.29   0.28   -1.7  -1.2e+00  -7.5e-01      3787      2879       17057    1.0
#> log_lik[6]      -6.0e-01  3.2e-03    0.20   0.19  -0.96  -5.7e-01  -3.1e-01      3692      2914       16629    1.0
#> log_lik[7]      -6.4e-01  1.9e-03    0.12   0.12  -0.86  -6.3e-01  -4.4e-01      4250      2980       19144    1.0
#> log_lik[8]      -2.8e-01  2.3e-03    0.14   0.12  -0.54  -2.6e-01  -1.0e-01      3826      3113       17236   1.00
#> log_lik[9]      -7.0e-01  2.7e-03    0.17   0.17   -1.0  -6.9e-01  -4.4e-01      3914      2704       17631    1.0
#> log_lik[10]     -7.4e-01  3.6e-03    0.23   0.23   -1.2  -7.2e-01  -4.1e-01      4136      3074       18629    1.0
#> log_lik[11]     -2.8e-01  2.2e-03    0.13   0.12  -0.52  -2.6e-01  -1.1e-01      3371      2585       15186    1.0
#> log_lik[12]     -5.0e-01  3.6e-03    0.24   0.22  -0.95  -4.5e-01  -1.9e-01      4259      3315       19185    1.0
#> log_lik[13]     -6.5e-01  3.5e-03    0.21   0.20   -1.0  -6.3e-01  -3.4e-01      3933      2661       17716    1.0
#> log_lik[14]     -3.6e-01  2.7e-03    0.17   0.16  -0.68  -3.3e-01  -1.4e-01      4005      3036       18039    1.0
#> log_lik[15]     -2.8e-01  1.8e-03    0.11   0.10  -0.48  -2.6e-01  -1.3e-01      3719      2919       16751    1.0
#> log_lik[16]     -2.8e-01  1.6e-03   0.091  0.086  -0.44  -2.7e-01  -1.5e-01      3355      2692       15112    1.0
#> log_lik[17]     -1.6e+00  5.0e-03    0.30   0.30   -2.1  -1.6e+00  -1.1e+00      3658      2840       16478    1.0
#> log_lik[18]     -4.8e-01  1.8e-03    0.11   0.11  -0.68  -4.7e-01  -3.1e-01      4043      3010       18211    1.0
#> log_lik[19]     -2.3e-01  1.3e-03   0.078  0.076  -0.37  -2.2e-01  -1.2e-01      3580      2848       16124    1.0
#> log_lik[20]     -1.1e-01  1.3e-03   0.079  0.060  -0.26  -9.2e-02  -2.8e-02      3884      3080       17494    1.0
#> log_lik[21]     -2.1e-01  1.5e-03   0.091  0.083  -0.38  -2.0e-01  -9.0e-02      3307      2504       14894    1.0
#> log_lik[22]     -5.7e-01  2.5e-03    0.15   0.15  -0.85  -5.6e-01  -3.4e-01      3749      2895       16889    1.0
#> log_lik[23]     -3.3e-01  2.3e-03    0.14   0.13  -0.60  -3.1e-01  -1.4e-01      4169      3088       18780   1.00
#> log_lik[24]     -1.4e-01  1.1e-03   0.068  0.061  -0.26  -1.2e-01  -5.2e-02      3666      3065       16514   1.00
#> log_lik[25]     -4.5e-01  1.8e-03    0.12   0.12  -0.67  -4.4e-01  -2.8e-01      4522      3033       20370    1.0
#> log_lik[26]     -1.5e+00  5.4e-03    0.35   0.34   -2.1  -1.5e+00  -1.0e+00      4289      2957       19320    1.0
#> log_lik[27]     -3.1e-01  2.2e-03    0.13   0.12  -0.55  -2.9e-01  -1.4e-01      3343      2620       15060    1.0
#> log_lik[28]     -4.5e-01  1.4e-03   0.087  0.085  -0.60  -4.4e-01  -3.1e-01      3626      3214       16336    1.0
#> log_lik[29]     -7.2e-01  3.4e-03    0.23   0.22   -1.1  -7.0e-01  -3.8e-01      4495      3056       20247    1.0
#> log_lik[30]     -7.0e-01  2.9e-03    0.19   0.19   -1.0  -6.8e-01  -4.1e-01      4602      3007       20732    1.0
#> log_lik[31]     -4.9e-01  2.8e-03    0.17   0.16  -0.79  -4.7e-01  -2.5e-01      3534      2882       15921    1.0
#> log_lik[32]     -4.3e-01  1.9e-03    0.11   0.11  -0.62  -4.2e-01  -2.6e-01      3493      2870       15733    1.0
#> log_lik[33]     -4.1e-01  1.8e-03    0.13   0.12  -0.63  -3.9e-01  -2.3e-01      4604      3000       20737    1.0
#> log_lik[34]     -6.4e-02  8.5e-04   0.052  0.036  -0.16  -5.0e-02  -1.3e-02      3709      2916       16709    1.0
#> log_lik[35]     -5.8e-01  2.8e-03    0.18   0.18  -0.91  -5.6e-01  -3.1e-01      4465      3087       20114    1.0
#> log_lik[36]     -3.3e-01  2.1e-03    0.13   0.12  -0.58  -3.0e-01  -1.5e-01      4580      2830       20629    1.0
#> log_lik[37]     -7.0e-01  3.5e-03    0.22   0.22   -1.1  -6.8e-01  -3.8e-01      4350      2872       19596    1.0
#> log_lik[38]     -3.1e-01  2.3e-03    0.15   0.13  -0.59  -2.8e-01  -1.2e-01      4122      3348       18566    1.0
#> log_lik[39]     -1.8e-01  1.8e-03    0.11  0.090  -0.38  -1.5e-01  -5.2e-02      3977      2910       17914    1.0
#> log_lik[40]     -6.8e-01  2.0e-03    0.13   0.13  -0.91  -6.8e-01  -4.8e-01      4356      3084       19622    1.0
#> log_lik[41]     -1.1e+00  4.6e-03    0.26   0.25   -1.6  -1.1e+00  -7.3e-01      3460      2970       15585    1.0
#> log_lik[42]     -9.3e-01  2.9e-03    0.20   0.20   -1.3  -9.2e-01  -6.4e-01      4690      2728       21126    1.0
#> log_lik[43]     -4.1e-01  4.1e-03    0.26   0.23  -0.91  -3.5e-01  -9.9e-02      4762      2863       21451    1.0
#> log_lik[44]     -1.2e+00  3.2e-03    0.19   0.19   -1.5  -1.2e+00  -8.9e-01      3527      2981       15887    1.0
#> log_lik[45]     -3.6e-01  1.9e-03    0.12   0.11  -0.57  -3.4e-01  -1.9e-01      3929      2940       17696    1.0
#> log_lik[46]     -5.8e-01  1.8e-03    0.13   0.13  -0.80  -5.7e-01  -3.9e-01      4867      3259       21924    1.0
#> log_lik[47]     -3.0e-01  2.0e-03    0.13   0.12  -0.54  -2.8e-01  -1.4e-01      4040      3186       18198    1.0
#> log_lik[48]     -3.2e-01  1.4e-03   0.086  0.083  -0.48  -3.2e-01  -2.0e-01      3804      3040       17134    1.0
#> log_lik[49]     -3.2e-01  1.4e-03   0.083  0.082  -0.47  -3.1e-01  -2.0e-01      3366      2805       15160   1.00
#> log_lik[50]     -1.3e+00  5.1e-03    0.33   0.33   -1.9  -1.3e+00  -8.0e-01      4368      2956       19677    1.0
#> log_lik[51]     -2.9e-01  1.5e-03   0.097  0.092  -0.46  -2.8e-01  -1.5e-01      4126      3183       18583    1.0
#> log_lik[52]     -8.3e-01  2.2e-03    0.14   0.14   -1.1  -8.2e-01  -6.2e-01      4233      3088       19068    1.0
#> log_lik[53]     -4.0e-01  2.3e-03    0.13   0.13  -0.65  -3.9e-01  -2.1e-01      3408      2858       15351    1.0
#> log_lik[54]     -3.7e-01  2.2e-03    0.14   0.13  -0.63  -3.5e-01  -1.8e-01      3969      3011       17878    1.0
#> log_lik[55]     -3.8e-01  1.9e-03    0.13   0.13  -0.62  -3.7e-01  -2.0e-01      4582      3282       20638    1.0
#> log_lik[56]     -3.2e-01  3.0e-03    0.19   0.17  -0.71  -2.8e-01  -9.2e-02      4892      2792       22035    1.0
#> log_lik[57]     -6.6e-01  1.8e-03    0.12   0.12  -0.86  -6.5e-01  -4.8e-01      4065      3068       18309    1.0
#> log_lik[58]     -9.6e-01  5.3e-03    0.35   0.34   -1.6  -9.1e-01  -4.6e-01      4725      3241       21282    1.0
#> log_lik[59]     -1.4e+00  5.1e-03    0.34   0.34   -2.0  -1.3e+00  -8.6e-01      4562      2994       20551    1.0
#> log_lik[60]     -9.8e-01  2.6e-03    0.16   0.16   -1.2  -9.7e-01  -7.3e-01      3931      2916       17707    1.0
#> log_lik[61]     -5.4e-01  1.5e-03   0.098  0.097  -0.71  -5.4e-01  -3.9e-01      4154      3222       18714    1.0
#> log_lik[62]     -8.8e-01  5.0e-03    0.31   0.30   -1.5  -8.4e-01  -4.4e-01      4049      3293       18239    1.0
#> log_lik[63]     -1.2e-01  1.3e-03   0.076  0.060  -0.26  -1.0e-01  -3.1e-02      3367      2447       15168   1.00
#> log_lik[64]     -9.0e-01  3.7e-03    0.25   0.25   -1.4  -8.8e-01  -5.3e-01      4679      2753       21078    1.0
#> log_lik[65]     -2.0e+00  1.1e-02    0.61   0.61   -3.1  -2.0e+00  -1.1e+00      3360      2436       15137    1.0
#> log_lik[66]     -5.1e-01  2.2e-03    0.14   0.13  -0.76  -5.0e-01  -3.1e-01      3896      2923       17550    1.0
#> log_lik[67]     -2.8e-01  1.4e-03   0.085  0.082  -0.43  -2.7e-01  -1.6e-01      3742      2937       16857    1.0
#> log_lik[68]     -1.1e+00  3.9e-03    0.24   0.24   -1.5  -1.0e+00  -7.0e-01      4016      2900       18091   1.00
#> log_lik[69]     -4.4e-01  1.5e-03   0.087  0.086  -0.59  -4.3e-01  -3.0e-01      3428      2827       15439   1.00
#> log_lik[70]     -6.4e-01  3.4e-03    0.23   0.23   -1.1  -6.1e-01  -3.1e-01      5102      2774       22982    1.0
#> log_lik[71]     -6.1e-01  3.3e-03    0.21   0.20  -0.99  -5.8e-01  -3.1e-01      4148      2936       18687    1.0
#> log_lik[72]     -4.6e-01  2.8e-03    0.17   0.16  -0.78  -4.3e-01  -2.2e-01      4277      2798       19268    1.0
#> log_lik[73]     -1.5e+00  5.7e-03    0.36   0.36   -2.1  -1.5e+00  -9.5e-01      4199      3107       18913    1.0
#> log_lik[74]     -9.5e-01  3.1e-03    0.19   0.20   -1.3  -9.3e-01  -6.5e-01      3901      2829       17571    1.0
#> log_lik[75]     -1.1e+00  6.3e-03    0.39   0.38   -1.8  -1.1e+00  -5.9e-01      4028      3044       18144    1.0
#> log_lik[76]     -3.7e-01  2.2e-03    0.14   0.13  -0.62  -3.5e-01  -1.8e-01      3961      3059       17840    1.0
#> log_lik[77]     -8.8e-01  2.4e-03    0.14   0.14   -1.1  -8.6e-01  -6.6e-01      3648      3157       16435    1.0
#> log_lik[78]     -4.9e-01  2.7e-03    0.17   0.17  -0.80  -4.7e-01  -2.5e-01      4225      3256       19034    1.0
#> log_lik[79]     -7.7e-01  3.0e-03    0.19   0.18   -1.1  -7.5e-01  -4.9e-01      4149      3215       18688    1.0
#> log_lik[80]     -5.4e-01  2.7e-03    0.19   0.19  -0.89  -5.1e-01  -2.7e-01      5032      3528       22667    1.0
#> log_lik[81]     -1.6e-01  1.5e-03   0.097  0.080  -0.35  -1.4e-01  -4.8e-02      4118      3003       18547    1.0
#> log_lik[82]     -2.2e-01  2.0e-03    0.14   0.12  -0.48  -1.9e-01  -6.3e-02      4413      3054       19880   1.00
#> log_lik[83]     -3.4e-01  1.4e-03   0.083  0.084  -0.49  -3.4e-01  -2.2e-01      3474      2963       15651   1.00
#> log_lik[84]     -2.8e-01  1.5e-03   0.092  0.090  -0.45  -2.6e-01  -1.4e-01      3598      2937       16207   1.00
#> log_lik[85]     -1.3e-01  1.2e-03   0.075  0.064  -0.27  -1.1e-01  -4.1e-02      3780      2909       17029   1.00
#> log_lik[86]     -1.1e+00  4.6e-03    0.31   0.32   -1.7  -1.1e+00  -6.7e-01      4890      3425       22025    1.0
#> log_lik[87]     -8.2e-01  2.0e-03    0.13   0.13   -1.0  -8.1e-01  -6.2e-01      4294      3300       19342    1.0
#> log_lik[88]     -7.7e-01  4.1e-03    0.25   0.24   -1.2  -7.4e-01  -4.2e-01      3778      2960       17017    1.0
#> log_lik[89]     -1.3e+00  4.8e-03    0.31   0.32   -1.8  -1.3e+00  -8.2e-01      4445      3255       20022    1.0
#> log_lik[90]     -2.6e-01  2.0e-03    0.13   0.12  -0.51  -2.3e-01  -9.3e-02      4439      3390       19997    1.0
#> log_lik[91]     -3.8e-01  1.9e-03    0.13   0.12  -0.62  -3.6e-01  -2.0e-01      4506      2707       20297    1.0
#> log_lik[92]     -1.5e+00  6.0e-03    0.35   0.35   -2.1  -1.5e+00  -9.7e-01      3606      2815       16242    1.0
#> log_lik[93]     -7.4e-01  3.5e-03    0.22   0.21   -1.1  -7.1e-01  -4.3e-01      4075      3041       18355    1.0
#> log_lik[94]     -3.2e-01  1.5e-03   0.089  0.088  -0.47  -3.1e-01  -1.9e-01      3593      2891       16186    1.0
#> log_lik[95]     -3.9e-01  2.0e-03    0.12   0.11  -0.60  -3.8e-01  -2.2e-01      3452      2922       15551    1.0
#> log_lik[96]     -1.6e+00  5.0e-03    0.29   0.30   -2.1  -1.6e+00  -1.1e+00      3520      2959       15854   1.00
#> log_lik[97]     -4.3e-01  1.6e-03    0.10  0.098  -0.62  -4.2e-01  -2.8e-01      4408      2968       19854    1.0
#> log_lik[98]     -1.1e+00  5.6e-03    0.37   0.36   -1.8  -1.0e+00  -5.3e-01      4724      3077       21280    1.0
#> log_lik[99]     -6.9e-01  2.1e-03    0.14   0.14  -0.94  -6.8e-01  -4.8e-01      4496      3184       20251    1.0
#> log_lik[100]    -3.9e-01  1.6e-03   0.099  0.097  -0.57  -3.8e-01  -2.5e-01      3979      2918       17924    1.0
#> 
#> Samples were drawn using hmc with nuts.
#> For each parameter, ESS_bulk and ESS_tail measure the effective sample size for the entire sample (bulk) and for the .05 and .95 tails (tail), 
#> and R_hat measures the potential scale reduction on split chains. At convergence R_hat will be very close to 1.00.
# }
```
